#!/usr/bin/osascript

use framework "CoreWLAN"
use framework "CoreLocation"

-- Request location permission
set locationManager to current application's CLLocationManager's alloc()'s init()
locationManager's requestWhenInUseAuthorization()
locationManager's startUpdatingLocation()

-- Wait a moment for authorization
delay 2

-- Try to get WiFi info
set client to current application's CWWiFiClient's sharedWiFiClient()
set wifiInterface to client's interface()
if wifiInterface is not missing value then
    set ssid to wifiInterface's ssid() as text
    set bssid to wifiInterface's bssid() as text
    set interfaceName to wifiInterface's interfaceName() as text
    return ssid & "|" & bssid & "|" & interfaceName
else
    return "||"
end if
